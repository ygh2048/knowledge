# 介绍

一个轻量级IP协议，适合嵌入式系统使用，属于TCP/IP 协议栈     

支持的协议类型：
- DNS 域名解析
- SNMP 简单网络管理协议
- DHCP 动态主机配置协议
- UDP 用户数据报协议
- TCP 
- 三种编程接口
- IP协议
- AUTOIP IP地址自动配置
- ICMP协议 用于网络调试和维护
- IGMP协议 用户网络组管理，可以实现多播数据的接收
- ARP协议 以太网地址解析协议
- PPP 点对点协议
三种编程接口:       
RAW API:

Nerconn API:


Socket API:

## 以太网基础知识

- CS架构
  - 客户端/服务器模式：是建立在局域网的基础上
  - 响应快，个性化，安全
  - 需要专门的客户端，兼容差，维护难
- BS架构
  - 浏览器/服务器模式：是建立在广域网的基础上
  - 分布性强，客户端零维护，开发简单
  - 个性化差，需要动态刷新
  - 安全差
  
# 硬件

以太网芯片LAN8720 相当于物理层（PHY层）  
STM32自带的MAC层相当于数据链路层        
LWIP提供的就是网络层和传输层的功能，需要用户自己实现    

## ETH逻辑（以太网）

使用DMA搬运



## RJ45



# 源码解析


## RTT的估计

RTT:往返时间，指从发送方发送一个数据包开始，到发送方收到接受方返回的确认数据包（ACK）为止，所消耗的总时间   

### 延迟
- 发送延迟
- 传播延迟
- 处理延迟
- 排队延迟


### RTO 超时时间

- 普通超时 等待RTO时间后未收到ACK就重传
- 快速重传 收到3个重复ACK,无需等待RTO,就直接重传

按照指数增大    

### 重传二义性

发送方无法确定收到的确认ACK是对应原始数据包还是重传的数据包，导致 
- RTT测量失真
- RTO计算错误
- 拥塞控制误判

解决：
karm算法，通过保守策略规避二义性数据
时间戳选项，彻底消除二义性


